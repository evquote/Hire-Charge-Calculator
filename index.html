<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Royal Birmingham Conservatoire — Multi-Venue Quote Calculator</title>
<style>
:root{
  --brand:#002e5b;
  --muted:#6b6b6b;
  --bg:#fafafa;
  --card:#ffffff;
}
body{font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:#222;margin:0;padding:20px;display:flex;justify-content:center;}
.wrapper{max-width:1000px;width:100%;}
header{display:flex;align-items:center;gap:16px;margin-bottom:18px;}
h1{font-size:20px;margin:0;color:var(--brand);}
.card{background:var(--card);padding:18px;border-radius:10px;box-shadow:0 6px 18px rgba(8,24,40,0.06);margin-bottom:14px;}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
label{display:block;font-size:13px;margin-bottom:6px;}
select,input[type=number]{width:100%;padding:8px;border:1px solid #ddd;border-radius:6px;box-sizing:border-box;}
.full{grid-column:1/-1;}
fieldset{border:1px solid #eee;padding:10px;border-radius:8px;margin:0;}
.checkbox-row{display:flex;align-items:center;justify-content:space-between;padding:6px 0;border-bottom:1px solid #fafafa;}
.qty{width:86px;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
th, td{border:1px solid #ddd;padding:8px;text-align:center;}
th{background:var(--brand);color:white;}
#grandTotal{font-weight:700;font-size:18px;color:var(--brand);text-align:right;margin-top:10px;}
button{background:var(--brand);color:white;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;margin-right:6px;}
.muted{color:var(--muted);font-size:13px;}
@media (max-width:700px){.grid{grid-template-columns:1fr;}header{flex-direction:column;align-items:flex-start;}}
</style>
</head>
<body>
<div class="wrapper">
<header>
  <div>
    <h1>Royal Birmingham Conservatoire — Multi-Venue Quote</h1>
    <div class="muted">Add multiple venues to generate a combined quote. All prices + VAT.</div>
  </div>
</header>

<div class="card">
  <div class="grid">

    <!-- Booking Times now at top -->
    <div class="full">
      <fieldset>
        <legend><strong>Booking Times & Event Day(s)</strong></legend>
        <div class="muted" style="margin-bottom:6px;">
          Please include your full booking time (get-in and get-out). Minimum 4-hour booking applies.<br>
          Regular hours: Mon–Fri 08:00–23:00, Sat–Sun 08:00–19:00.<br>
          After-hours surcharge: £20/hour + VAT applies outside these hours.
        </div>

        <div style="display:flex;gap:10px;margin-bottom:6px;">
          <div style="flex:1">
            <label for="startTime">Booking Start Time</label>
            <select id="startTime"></select>
          </div>
          <div style="flex:1">
            <label for="endTime">Booking End Time</label>
            <select id="endTime"></select>
          </div>
        </div>

        <div style="margin-bottom:6px;">
          <label><strong>Event Day(s)</strong></label>
          <div style="display:flex;flex-wrap:wrap;gap:10px;margin-top:4px;">
            <label><input type="checkbox" class="day" value="Mon"> Mon</label>
            <label><input type="checkbox" class="day" value="Tue"> Tue</label>
            <label><input type="checkbox" class="day" value="Wed"> Wed</label>
            <label><input type="checkbox" class="day" value="Thu"> Thu</label>
            <label><input type="checkbox" class="day" value="Fri"> Fri</label>
            <label><input type="checkbox" class="day" value="Sat"> Sat</label>
            <label><input type="checkbox" class="day" value="Sun"> Sun</label>
          </div>
        </div>
      </fieldset>
    </div>

    <div>
      <label for="venue">Venue / Space</label>
      <select id="venue">
        <option value="">— select venue —</option>
        <option value="Bradshaw">Bradshaw Hall</option>
        <option value="Recital">Recital Hall</option>
        <option value="Lab">The Lab</option>
        <option value="Jazz">Eastside Jazz Club</option>
        <option value="Organ">Organ Studio</option>
        <option value="WorkshopLarge">Workshop Space Large</option>
        <option value="WorkshopSmall">Workshop Space Small</option>
        <option value="DLHub">Distance Learning Hub</option>
        <option value="PracticeGrand2">Practice Room (2 grands)</option>
        <option value="PracticeGrand">Practice Room (grand)</option>
        <option value="PracticeUpright">Practice Room (upright)</option>
        <option value="Dressing">Additional Dressing Rooms</option>
      </select>
    </div>

    <div>
      <label for="hireType">Hire Type</label>
      <select id="hireType">
        <option value="standard">Standard Rate (includes FOH staff)</option>
        <option value="premium">Recording / Premium Workshop (dry hire)</option>
      </select>
    </div>

    <div class="full">
      <fieldset>
        <legend><strong>Technical / Equipment</strong></legend>
        <div class="muted" style="margin-bottom:6px;">Quantity</div>
        <div class="checkbox-row"><div>PA (per day)</div><div><input id="pa_qty" class="qty" type="number" min="0" value="0" /></div></div>
        <div class="checkbox-row"><div>Projector (per day)</div><div><input id="projector_qty" class="qty" type="number" min="0" value="0" /></div></div>
        <div class="checkbox-row"><div>Microphone (wired)</div><div><input id="mic_wired_qty" class="qty" type="number" min="0" value="0" /></div></div>
        <div class="checkbox-row"><div>Microphone (wireless)</div><div><input id="mic_wireless_qty" class="qty" type="number" min="0" value="0" /></div></div>
        <div class="checkbox-row"><div>Monitor</div><div><input id="monitor_qty" class="qty" type="number" min="0" value="0" /></div></div>
        <div class="checkbox-row"><div>Overhead audio recording</div><div><input id="overhead_qty" class="qty" type="number" min="0" value="0" /></div></div>
        <div class="checkbox-row"><div>Static video recording</div><div><input id="video_qty" class="qty" type="number" min="0" value="0" /></div></div>
        <div class="checkbox-row"><div>Laptop</div><div><input id="laptop_qty" class="qty" type="number" min="0" value="0" /></div></div>
        <div class="checkbox-row"><div>Grand Piano</div><div><input id="piano_qty" class="qty" type="number" min="0" value="0" /></div></div>
        <div class="muted" style="margin-top:6px;">Other instrument hire is available upon request, subject to availability.</div>
      </fieldset>
    </div>

    <div class="full" style="margin-top:10px;">
      <button id="addBtn">Add to Quote</button>
      <button id="emailBtn">Email Quote</button>
      <button id="downloadBtn">Download HTML</button>
    </div>
  </div>
</div>

<div class="card">
  <h3 style="margin-top:0">Quote Summary</h3>
  <table id="orderTable">
    <thead>
      <tr>
        <th>Venue</th><th>Hire Type</th><th>Hours</th><th>Base (£)</th><th>Equipment (£)</th><th>Subtotal (£)</th><th>VAT (£)</th><th>Total (£)</th><th>Remove</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <div id="grandTotal">Grand Total: £0.00</div>
  <div class="muted" style="margin-top:6px;">Technician hours will be quoted separately based on the technical requirements of the event.</div>
  <div class="muted" style="margin-top:6px;">After-hours surcharge: £20/hour + VAT applies outside regular opening hours.</div>
  <div class="muted">For booking & detailed technical quotes contact: conservatoireevents@bcu.ac.uk</div>
</div>
</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{
  const rates={Bradshaw:{standard:250,premium:125},Recital:{standard:200,premium:100},Lab:{standard:175,premium:87.5},
  Jazz:{standard:175,premium:87.5},Organ:{standard:150,premium:75},WorkshopLarge:{standard:60,premium:60},
  WorkshopSmall:{standard:50,premium:50},DLHub:{standard:35,premium:35},PracticeGrand2:{standard:40,premium:40},
  PracticeGrand:{standard:30,premium:30},PracticeUpright:{standard:25,premium:25},Dressing:{standard:25,premium:25}};
  const mainVenues=['Bradshaw','Recital','Jazz','Organ','Lab'];
  const order=[]; const PIANO_RATE=100;

  const formatGBP=n=>'£'+n.toFixed(2);

  function populateTimes(){
    const start=document.getElementById('startTime'), end=document.getElementById('endTime');
    for(let h=0;h<24;h++){for(let m=0;m<60;m+=30){
      const v=('0'+h).slice(-2)+':'+('0'+m).slice(-2);
      [start,end].forEach(sel=>{const o=document.createElement('option');o.value=v;o.textContent=v;sel.appendChild(o);});
    }}
    start.value='09:00'; end.value='13:00';
  }
  populateTimes();

  function timeToHours(t){const [h,m]=t.split(':').map(Number);return h+m/60;}
  function getBookingHours(){
    let diff=timeToHours(endTime.value)-timeToHours(startTime.value);
    if(diff<0) diff+=24; // overnight handling if needed
    return Math.max(diff,4); // enforce 4h min
  }

  function calcCosts(rate,h,e){
    const base=rate*h;
    const addons=(e.pa||0)*100+(e.projector||0)*250+(e.micWired||0)*20+(e.micWireless||0)*40+
                 (e.monitor||0)*15+(e.overhead||0)*100+(e.video||0)*250+(e.laptop||0)*50+(e.piano||0)*PIANO_RATE;
    const sub=base+addons, vat=sub*0.2, total=sub+vat;
    return {base,addons,subtotal:sub,vat,total};
  }

  function calcAfterHours(){
    const days=[...document.querySelectorAll('.day:checked')].map(d=>d.value);
    if(!days.length)return{total:0};
    const s=timeToHours(startTime.value), e=timeToHours(endTime.value);
    let sur=0;
    days.forEach(d=>{
      const open=8, close=(d==='Sat'||d==='Sun')?19:23;
      if(s<open) sur+=Math.max(0,open-s)*20;
      if(e>close) sur+=Math.max(0,e-close)*20;
    });
    return{total:sur*1.2};
  }

  function updateTable(){
    const tb=document.querySelector('#orderTable tbody'); tb.innerHTML='';
    let grand=0;
    order.forEach((it,i)=>{
      const r=document.createElement('tr');
      r.innerHTML=`<td>${it.venue}</td><td>${it.hireType}</td><td>${it.hours}</td>
      <td>${formatGBP(it.costs.base)}</td><td>${formatGBP(it.costs.addons)}</td>
      <td>${formatGBP(it.costs.subtotal)}</td><td>${formatGBP(it.costs.vat)}</td>
      <td>${formatGBP(it.costs.total)}</td><td><button onclick="removeItem(${i})">Remove</button></td>`;
      tb.appendChild(r); grand+=it.costs.total;
    });
    const after=calcAfterHours();
    document.getElementById('grandTotal').textContent='Grand Total: '+formatGBP(grand+after.total);
  }

  window.removeItem=i=>{order.splice(i,1);updateTable();};

  addBtn.onclick=()=>{
    const v=venue.value; if(!v){alert('Please select a venue');return;}
    const hType=hireType.value;
    const hours=getBookingHours();
    const eq={pa:+pa_qty.value,projector:+projector_qty.value,micWired:+mic_wired_qty.value,
      micWireless:+mic_wireless_qty.value,monitor:+monitor_qty.value,overhead:+overhead_qty.value,
      video:+video_qty.value,laptop:+laptop_qty.value,piano:+piano_qty.value};
    const rate=rates[v][hType]; const costs=calcCosts(rate,hours,eq);
    order.push({venue:v,hireType:hType,hours,costs}); updateTable();
  };

  emailBtn.onclick=()=>{
    if(!order.length)return alert('Add at least one venue first.');
    const after=calcAfterHours();
    const grand=order.reduce((a,b)=>a+b.costs.total,0)+after.total;
    let body=order.map((it,i)=>`Item ${i+1}: ${it.venue} (${it.hireType}) ${it.hours}h | Base ${formatGBP(it.costs.base)} | Equip ${formatGBP(it.costs.addons)} | Total ${formatGBP(it.costs.total)}`).join('\n');
    body+=`\n\nAfter-hours surcharge: ${formatGBP(after.total)}\nGrand Total: ${formatGBP(grand)}\n\nTechnician hours quoted separately.`;
    location.href=`mailto:conservatoireevents@bcu.ac.uk?subject=${encodeURIComponent('RBC Event Quote')}&body=${encodeURIComponent(body)}`;
  };

  downloadBtn.onclick=()=>{
    let html=`<html><head><title>Quote</title></head><body><h1>Quote Summary</h1><table border="1" cellpadding="5"><tr><th>Venue</th><th>Hire Type</th><th>Hours</th><th>Base</th><th>Equip</th><th>Subtotal</th><th>VAT</th><th>Total</th></tr>`;
    order.forEach(it=>{html+=`<tr><td>${it.venue}</td><td>${it.hireType}</td><td>${it.hours}</td><td>${formatGBP(it.costs.base)}</td><td>${formatGBP(it.costs.addons)}</td><td>${formatGBP(it.costs.subtotal)}</td><td>${formatGBP(it.costs.vat)}</td><td>${formatGBP(it.costs.total)}</td></tr>`;});
    const after=calcAfterHours();
    const grand=order.reduce((a,b)=>a+b.costs.total,0)+after.total;
    html+=`<tr><td colspan="7" style="text-align:right">After-hours surcharge</td><td>${formatGBP(after.total)}</td></tr>`;
    html+=`<tr><td colspan="7" style="text-align:right"><strong>Grand Total</strong></td><td><strong>${formatGBP(grand)}</strong></td></tr></table></body></html>`;
    const blob=new Blob([html],{type:'text/html'}); const url=URL.createObjectURL(blob);
    const a=document.createElement('a'); a.href=url; a.download='quote.html'; a.click(); URL.revokeObjectURL(url);
  };
});
</script>
</body>
</html>
